<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Metrics for the assessment of post-imputation structural preservation — computeStructuralMetrics • msImpute</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Metrics for the assessment of post-imputation structural preservation — computeStructuralMetrics" />
<meta property="og:description" content="For an imputed dataset, it computes within phenotype/experimental condition similarity
(i.e. preservation of local structures), between phenotype distances
(preservation of global structures), and the Gromov-Wasserstein (GW)
distance between original (source) and imputed data." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msImpute</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/msImpute-vignette.html">msImpute: Imputation of peptide intensity by low-rank approximation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DavisLaboratory/msImpute/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Metrics for the assessment of post-imputation structural preservation</h1>
    <small class="dont-index">Source: <a href='https://github.com/DavisLaboratory/msImpute/blob/master/R/computeStructuralMetrics.R'><code>R/computeStructuralMetrics.R</code></a></small>
    <div class="hidden name"><code>computeStructuralMetrics.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For an imputed dataset, it computes within phenotype/experimental condition similarity
(i.e. preservation of local structures), between phenotype distances
(preservation of global structures), and the Gromov-Wasserstein (GW)
distance between original (source) and imputed data.</p>
    </div>

    <pre class="usage"><span class='fu'>computeStructuralMetrics</span><span class='op'>(</span><span class='va'>x</span>, group <span class='op'>=</span> <span class='cn'>NULL</span>, y <span class='op'>=</span> <span class='cn'>NULL</span>, k <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric matrix. An imputed data matrix of log-intensity.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>factor. A vector of biological groups, experimental conditions or
phenotypes (e.g. control, treatment).</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric matrix. The source data (i.e. the original log-intensity matrix),
preferably subsetted on highly variable peptides (see <code>findVariableFeatures</code>).</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>numeric. Number of Principal Components used to compute the GW distance.
default to 2.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list of three metrics: withinness (sum of squared distances within a phenotype group),
betweenness (sum of squared distances between the phenotypes), and gromov-wasserstein distance (if <code>xna</code> is not NULL).
if <code>group</code> is NULL only the GW distance is returned. All metrics are on log scale.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For each group of experimental conditions (e.g. treatment and control), the group centroid is
calculated as the average of observed peptide intensities. Withinness for each group is computed as
sum of the squared distances between samples in that group and
the group centroid. Betweenness is computed as sum of the squared distances between group centroids.
When comparing imputation approaches, the optimal imputation strategy should minimize the within
group distances, hence smaller withinness, and maximizes between group distances, hence larger betweenness.
The GW metric considers preservation of both local and global structures simultaneously. A small GW distance
suggests that imputation has introduced small distortions to global and local structures overall, whereas a
large distance implies significant distortions. When comparing two or more imputation methods, the optimal
method is the method with smallest GW distance. The GW distance is computed on Principal Components (PCs)
of the source and imputed data, instead of peptides. Principal components capture the geometry of the data,
hence GW computed on PCs is a better measure of preservation of local and global structures. The PCs in the
source data are recommended to be computed on peptides with high biological variance. Hence, users are
recommended to subset the source data only on highly variable peptides (hvp) (see <code>findVariableFeatures</code>).
Since the hvp peptides have high biological variance, they are likely to have enough information to discriminate
samples from different experimental groups. Hence, PCs computed on those peptides should be representative
of the original source data with missing values. If the samples cluster by experimental group in the first
couple of PCs, then a choice of k=2 is reasonable. If the desired separation/clustering of samples
occurs in later PCs (i.e. the first few PCs are dominated by batches or unwanted variability), then
it is recommended to use a larger number of PCs to compute the GW metric.
If you are interested in how well the imputed data represent the original data in all possible dimensions,
then set k to the number of samples in the data (i.e. the number of columns in the intensity matrix).
GW distance estimation requires <code>python</code>. See example. All metrics are on log scale.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hediyeh-zadeh, S., Webb, A. I., &amp; Davis, M. J. (2020). MSImpute: Imputation of label-free mass spectrometry peptides by low-rank approximation. bioRxiv.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pxd010943</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.matrix.html'>data.matrix</a></span><span class='op'>(</span><span class='va'>pxd010943</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/stats/complete.cases.html'>complete.cases</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,<span class='op'>]</span>
<span class='va'>group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"_[1234]"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>computeStructuralMetrics</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>group</span>, y<span class='op'>=</span><span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $withinness
#&gt;      Gfi1  R412Xhet R412Xhomo     K403R 
#&gt;  9.552566  9.860728  7.231686  6.431940 
#&gt; 
#&gt; $betweenness
#&gt; [1] 10.51624
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Soroor Hediyeh-zadeh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


