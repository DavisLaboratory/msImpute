<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peptide-level imputation in mass spectrometry label-free proteomics by low-rank approximation — msImpute • msImpute</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Peptide-level imputation in mass spectrometry label-free proteomics by low-rank approximation — msImpute" />
<meta property="og:description" content="Returns a completed peptide intensity matrix where missing values (NAs) are imputated
by low-rank approximation of the input matrix. Non-NA entries remain unmodified. msImpute requires at least 4
non-missing measurements per peptide across all samples. It is assumed that peptide intensities  (DDA), or MS1/MS2 normalised peak areas (DIA),
are log2-transformed and normalised (e.g. quantile normalisation)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msImpute</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/msImpute-vignette.html">msImpute: Imputation of peptide intensity by low-rank approximation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DavisLaboratory/msImpute/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peptide-level imputation in mass spectrometry label-free proteomics by low-rank approximation</h1>
    <small class="dont-index">Source: <a href='https://github.com/DavisLaboratory/msImpute/blob/master/R/msImpute.R'><code>R/msImpute.R</code></a></small>
    <div class="hidden name"><code>msImpute.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns a completed peptide intensity matrix where missing values (NAs) are imputated
by low-rank approximation of the input matrix. Non-NA entries remain unmodified. <code>msImpute</code> requires at least 4
non-missing measurements per peptide across all samples. It is assumed that peptide intensities  (DDA), or MS1/MS2 normalised peak areas (DIA),
are log2-transformed and normalised (e.g. quantile normalisation).</p>
    </div>

    <pre class="usage"><span class='fu'>msImpute</span>(
  <span class='kw'>object</span>,
  rank.max = <span class='kw'>NULL</span>,
  lambda = <span class='kw'>NULL</span>,
  thresh = <span class='fl'>1e-05</span>,
  maxit = <span class='fl'>100</span>,
  trace.it = <span class='fl'>FALSE</span>,
  warm.start = <span class='kw'>NULL</span>,
  final.svd = <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Numeric matrix giving log-intensity where missing values are denoted by NA. Rows are peptides, columns are samples.</p></td>
    </tr>
    <tr>
      <th>rank.max</th>
      <td><p>Numeric. This restricts the rank of the solution. is set to min(dim(<code>object</code>)-1) by default.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Numeric. Nuclear-norm regularization parameter. Controls the low-rank property of the solution
to the matrix completion problem. By default, it is determined at the scaling step. If set to zero
the algorithm reverts to "hardImputation", where the convergence will be slower.</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>Numeric. Convergence threshold. Set to 1e-05, by default.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>Numeric. Maximum number of iterations of the algorithm before the algorithm is converged. 100 by default.</p></td>
    </tr>
    <tr>
      <th>trace.it</th>
      <td><p>Logical. Prints traces of progress of the algorithm.</p></td>
    </tr>
    <tr>
      <th>warm.start</th>
      <td><p>List. A SVD object can be used to initialize the algorithm instead of random initialization.</p></td>
    </tr>
    <tr>
      <th>final.svd</th>
      <td><p>Logical. Shall final SVD object be saved? The solutions to the matrix completion problems are computed from U, D and V components of final SVD.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Missing values are imputed by low-rank approximation of the input matrix. If input is a numeric matrix,
a numeric matrix of identical dimensions is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>msImpute</code> operates on the softImpute-ALS algorithm.
For more details on the underlying algorithm, please see <code><a href='https://rdrr.io/pkg/softImpute/man/softImpute.html'>softImpute</a></code> package.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hastie, T., Mazumder, R., Lee, J. D., &amp; Zadeh, R. (2015). Matrix completion and low-rank SVD via fast alternating least squares. The Journal of Machine Learning Research, 16(1), 3367-3402.</p>
<p>Hediyeh-zadeh, S., Webb, A. I., &amp; Davis, M. J. (2020). MSImpute: Imputation of label-free mass spectrometry peptides by low-rank approximation. bioRxiv.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>selectFeatures, scaleData</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>101</span>)
<span class='kw'>n</span><span class='op'>=</span><span class='fl'>12000</span>
<span class='kw'>p</span><span class='op'>=</span><span class='fl'>10</span>
<span class='kw'>J</span><span class='op'>=</span><span class='fl'>5</span>
<span class='kw'>np</span><span class='op'>=</span><span class='kw'>n</span><span class='op'>*</span><span class='kw'>p</span>
<span class='kw'>missfrac</span><span class='op'>=</span><span class='fl'>0.3</span>
<span class='kw'>x</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='kw'>n</span><span class='op'>*</span><span class='kw'>J</span>,mean = <span class='fl'>5</span>,sd = <span class='fl'>0.2</span>),<span class='kw'>n</span>,<span class='kw'>J</span>)<span class='op'>%*%</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='kw'>J</span><span class='op'>*</span><span class='kw'>p</span>, mean = <span class='fl'>5</span>,sd = <span class='fl'>0.2</span>),<span class='kw'>J</span>,<span class='kw'>p</span>)<span class='op'>+</span>
  <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='kw'>np</span>,mean = <span class='fl'>5</span>,sd = <span class='fl'>0.2</span>),<span class='kw'>n</span>,<span class='kw'>p</span>)<span class='op'>/</span><span class='fl'>5</span>
<span class='kw'>ix</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='kw'>np</span>)
<span class='kw'>imiss</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='kw'>ix</span>,<span class='kw'>np</span><span class='op'>*</span><span class='kw'>missfrac</span>,replace=<span class='fl'>FALSE</span>)
<span class='kw'>xna</span><span class='op'>=</span><span class='kw'>x</span>
<span class='kw'>xna</span>[<span class='kw'>imiss</span>]<span class='op'>=</span><span class='fl'>NA</span>
<span class='kw'>keep</span> <span class='op'>&lt;-</span> (<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='kw'>xna</span>)) <span class='op'>&gt;=</span> <span class='fl'>4</span>)
<span class='kw'>xna</span> <span class='op'>&lt;-</span> <span class='kw'>xna</span>[<span class='kw'>keep</span>,]
<span class='kw'>xna</span> <span class='op'>&lt;-</span> <span class='fu'><a href='scaleData.html'>scaleData</a></span>(<span class='kw'>xna</span>)
</div><div class='output co'>#&gt; bi-scaling ...
#&gt; data scaled </div><div class='input'><span class='kw'>xcomplete</span> <span class='op'>&lt;-</span> <span class='fu'>msImpute</span>(object=<span class='kw'>xna</span>)
</div><div class='output co'>#&gt; maximum rank is 9 
#&gt; computing lambda0 ... 
#&gt; lambda0 is 134.2294 
#&gt; fit the low-rank model ... 
#&gt; model fitted. 
#&gt; Imputting missing entries ... 
#&gt; Imputation completed </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Soroor Hediyeh-zadeh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


