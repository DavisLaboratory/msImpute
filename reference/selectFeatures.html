<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Select features for MAR/MNAR pattern examination — selectFeatures • msImpute</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Select features for MAR/MNAR pattern examination — selectFeatures" />
<meta property="og:description" content="Two methods are provided to identify features (peptides or proteins) that can be informative of missing patterns.
Method hvp fits a linear model to peptide dropout rate (proportion of samples were peptide is missing)
against peptide abundance (average log2-intensity). Method emb is a information theoretic approach to
identify missing patterns. It quantifies the heterogeneity (entropy) of missing patterns per
biological (experimental group). This is the default method." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msImpute</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/msImpute-vignette.html">msImpute: Imputation of peptide intensity by low-rank approximation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DavisLaboratory/msImpute/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Select features for MAR/MNAR pattern examination</h1>
    <small class="dont-index">Source: <a href='https://github.com/DavisLaboratory/msImpute/blob/master/R/selectFeatures.R'><code>R/selectFeatures.R</code></a></small>
    <div class="hidden name"><code>selectFeatures.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Two methods are provided to identify features (peptides or proteins) that can be informative of missing patterns.
Method <code>hvp</code> fits a linear model to peptide dropout rate (proportion of samples were peptide is missing)
against peptide abundance (average log2-intensity). Method <code>emb</code> is a information theoretic approach to
identify missing patterns. It quantifies the heterogeneity (entropy) of missing patterns per
biological (experimental group). This is the default method.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>selectFeatures</span><span class='op'>(</span>
  <span class='va'>x</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ebm"</span>, <span class='st'>"hvp"</span><span class='op'>)</span>,
  <span class='va'>group</span>,
  n_features <span class='op'>=</span> <span class='fl'>500</span>,
  suppress_plot <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Numeric matrix giving log-intensity where missing values are denoted by NA.
Rows are peptides, columns are samples.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character. What method should be used to find features? options include <code>method='hvp'</code> and <code>method='ebm'</code></p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>character or factor vector specifying biological (experimental) group e.g. control, treatment, WT, KO</p></td>
    </tr>
    <tr>
      <th>n_features</th>
      <td><p>Numeric, number of features with high dropout rate. 500 by default. Applicable if <code>method="hvp"</code>.</p></td>
    </tr>
    <tr>
      <th>suppress_plot</th>
      <td><p>Logical show plot of dropouts vs abundances. Default to TRUE. Applicable if <code>method="hvp"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with a logical column denoting the selected features</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In general, the presence of group-wise (structured) blocks of missing values,
where peptides are missing in one experimental group can indicate MNAR, whereas if
such patterns are absent (or missingness is uniform across the samples), peptides are likely MAR.
In the presence of MNAR, left-censored MNAR imputation methods should
be chosen. Two methods are provided to explore missing patterns: <code>method=hvp</code> identifies top <code>n_features</code>
peptides with high average expression that also have high dropout rate, defined as the proportion of samples where
peptide is missing. Peptides with high (potentially) biological dropouts are marked in the <code>hvp</code> column in the
output dataframe. This method does not use any information about experimental conditions (i.e. group).
Another approach to explore and quantify missing patterns is by looking at how homogeneous or heterogeneous
missing patterns are in each experimental group. This is done by computing entropy of distribution of observed values.
This is the default and recommended method for <code>selectFeatures</code>. Entropy is reported in <code>EBM</code> column
of the output. A <code>NaN</code> EBM indicates peptide is missing at least in one experimental group. Features set to
<code>TRUE</code> in <code>msImpute_feature</code> column are the features selected by the selected method. Users are encouraged
to use the EBM metric to find informative features, hence why the <code>group</code> argument is required.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hediyeh-zadeh, S., Webb, A. I., &amp; Davis, M. J. (2020). MSImpute: Imputation of label-free mass spectrometry peptides by low-rank approximation. bioRxiv.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>msImpute</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Soroor Hediyeh-zadeh</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>pxd007959</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>group</span> <span class='op'>&lt;-</span> <span class='va'>pxd007959</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.matrix.html'>data.matrix</a></span><span class='op'>(</span><span class='va'>pxd007959</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>hdp</span> <span class='op'>&lt;-</span> <span class='fu'>selectFeatures</span><span class='op'>(</span><span class='va'>y</span>, method<span class='op'>=</span><span class='st'>"ebm"</span>, group <span class='op'>=</span> <span class='va'>group</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># construct matrix M to capture missing entries</span></span>
<span class='r-in'><span class='va'>M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>M</span> <span class='op'>&lt;-</span> <span class='va'>M</span><span class='op'>[</span><span class='va'>hdp</span><span class='op'>$</span><span class='va'>msImpute_feature</span>,<span class='op'>]</span></span>
<span class='r-in'><span class='co'># plot a heatmap of missingness patterns for the selected peptides</span></span>
<span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jokergoo/ComplexHeatmap'>ComplexHeatmap</a></span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: ComplexHeatmap</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Loading required package: grid</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ========================================</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ComplexHeatmap version 2.9.0</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Bioconductor page: http://bioconductor.org/packages/ComplexHeatmap/</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Github page: https://github.com/jokergoo/ComplexHeatmap</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Documentation: http://jokergoo.github.io/ComplexHeatmap-reference</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> If you use it in published research, please cite:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Gu, Z. Complex heatmaps reveal patterns and correlations in multidimensional </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>   genomic data. Bioinformatics 2016.</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> The new InteractiveComplexHeatmap package can directly export static </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> complex heatmaps into an interactive Shiny app with zero effort. Have a try!</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> This message can be suppressed by:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>   suppressPackageStartupMessages(library(ComplexHeatmap))</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> ========================================</span>
<span class='r-in'><span class='va'>hm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>Heatmap</a></span><span class='op'>(</span><span class='va'>M</span>,</span>
<span class='r-in'>column_title <span class='op'>=</span> <span class='st'>"dropout pattern, columns ordered by dropout similarity"</span>,</span>
<span class='r-in'>              name <span class='op'>=</span> <span class='st'>"Intensity"</span>,</span>
<span class='r-in'>              col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8FBC8F"</span>, <span class='st'>"#FFEFDB"</span><span class='op'>)</span>,</span>
<span class='r-in'>              show_row_names <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>              show_column_names <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>              cluster_rows <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>              cluster_columns <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>              show_column_dend <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>              show_row_dend <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>              row_names_gp <span class='op'>=</span>  <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fontsize <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span>,</span>
<span class='r-in'>              column_names_gp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/gpar.html'>gpar</a></span><span class='op'>(</span>fontsize <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span class='r-in'>              heatmap_legend_param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='co'>#direction = "horizontal",</span></span>
<span class='r-in'>              heatmap_legend_side <span class='op'>=</span> <span class='st'>"bottom"</span>,</span>
<span class='r-in'>              labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"observed"</span>,<span class='st'>"missing"</span><span class='op'>)</span>,</span>
<span class='r-in'>              legend_width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span class='r-in'>         <span class='op'>)</span></span>
<span class='r-in'><span class='va'>hm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html'>draw</a></span><span class='op'>(</span><span class='va'>hm</span>, heatmap_legend_side <span class='op'>=</span> <span class='st'>"left"</span><span class='op'>)</span></span>
<span class='r-plt'><img src='selectFeatures-1.png' alt='' width='700' height='433' /></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Soroor Hediyeh-zadeh.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


