<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Imputation of label-free mass spectrometry peptides • msImpute</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Imputation of label-free mass spectrometry peptides">
<meta property="og:description" content='MsImpute is a package for imputation of peptide intensity in proteomics experiments.
    It additionally contains tools for MAR/MNAR diagnosis and assessment of distortions to the probability 
    distribution of the data post imputation.  The missing values are imputed by low-rank approximation of
    the underlying data matrix if they are MAR (method = "v2"), by Barycenter approach if missingness is 
    MNAR ("v2-mnar"), or by Peptide Identity Propagation (PIP).'>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">msImpute</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/msImpute-vignette.html">msImpute: Imputation of peptide intensity by low-rank approximation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DavisLaboratory/msImpute/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="msimpute---methods-for-label-free-mass-spectrometry-proteomics-imputation" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#msimpute---methods-for-label-free-mass-spectrometry-proteomics-imputation" class="anchor" aria-hidden="true"></a>msImpute - Methods for label-free mass spectrometry proteomics imputation</h1></div>
<p>MsImpute is a R package for imputation of peptide intensity in proteomics experiments. It additionally contains tools for MAR/MNAR diagnosis and assessment of distortions to the probability distribution of the data post imputation.</p>
<p>The missing values are imputed by low-rank approximation of the underlying data matrix if they are MAR (method = “v2”), by Barycenter approach if missingness is MNAR (“v2-mnar”), or by Peptide Identity Propagation (PIP). While “v2” approach is more appropriate for imputation of data acquired by DIA, “v2-mnar” is designed for imputation of DDA, TMT and time-series datasets. However, the true dynamic range can not be reliably recovered by imputation, particularly in datasets with small sample sizes (for example, 3-5 replicates per experimental condition).</p>
<p>Our PIP approach infers the missing intensity values for an identification based on similarity of LC-MS features of peptide-like signals detected in MS1 (e.g. by a feature detector) and the identified peptides. We currently support MaxQuant outputs, including DDA-PASEF datasets. <strong>We strongly recommend the PIP approach for imputation of time-series, or datasets which suffer from large (&gt; 50%) missing values per run</strong>. Our PIP enhances data completeness, while reporting <em>weights</em> that measure the confidence in propagation. These can be used as observation-level weights in <em>limma</em> linear models to improve differential expression testing, by incorporating the uncertainty in intensity values that are inferred by PIP into the model.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor" aria-hidden="true"></a>Installation</h2>
<p>Install from Github:</p>
<pre><code>install.packages("devtools") # devtools is required to download and install the package
devtools::install_github("DavisLaboratory/msImpute")</code></pre>
<p>Install from Bioconductor:</p>
<pre><code>if(!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("msImpute")</code></pre>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor" aria-hidden="true"></a>Quick Start</h2>
<pre><code><a href="https://github.com/rstudio/reticulate" class="external-link">library(reticulate)
library(msImpute)

# xna is a numeric matrix with NAs (for MAR/MNAR diagnosis only)
# "group" defines experimental condition (e.g. control, treatment etc).

# select peptides missing in at least one experimental group
selectFeatures(xna, method="ebm", group=group) 


# select peptides that can be informative for
# exploring missing value patterns at high abundance
selectFeatures(xna, method="hvp", n_features=500) 


# impute MAR data by low-rank models (v2 is enhanced version of v1 implementation)
xcomplete &lt;- msImpute(xna, method="v2") 


# impute MNAR data by low-rank models (adaptation of low-rank models for MNAR data)
xcomplete &lt;- msImpute(xna, method="v2-mnar", group=group)  


# Requires python. See Manual for more information.
top.hvp &lt;- findVariableFeatures(xna)
computeStructuralMetrics(xcomplete, 
                         group, 
                         xna[rownames(top.hvp)[1:50],], 
                         k = 2) 

</a></code></pre>
</div>
<div id="new-feature--mspip" class="section level2">
<h2 class="hasAnchor">
<a href="#new-feature--mspip" class="anchor" aria-hidden="true"></a>New feature : msPIP</h2>
<p><strong>PIP reduces the proportion of missing values substantially, almost to zero.</strong></p>
<p>Figure: The proportion of missing peptides per sample in PASS00589 DDA dataset before and after PIP.</p>
<p><img src="https://user-images.githubusercontent.com/7257233/121839424-5c3a4380-cd1d-11eb-84fa-437a387c44f2.png" width="700px" align="center"></p>
<p><strong>PIP recovers the low abundance peptides and re-constructs the true dynamic range</strong></p>
<p>Low-abundance peptides not quantified by MaxQuant are recovered, and differential expression results are improved. Note down regulated peptides that are not present in the volcano plot of DE test on MQ-reported data (bottom left), that are recovered by PIP (bottom right volcano plot) for the same experimental contrast.</p>
<p><img src="https://user-images.githubusercontent.com/7257233/121839859-55600080-cd1e-11eb-998e-f7e60896b1bf.png" width="700px" align="center"></p>
<p>Need more help to start? We have collected a number of <strong>case studies</strong> <a href="https://github.com/soroorh/proteomicscasestudies/blob/master/msImputeUsersGuide.pdf" class="external-link">here</a></p>
<p><strong>Reference</strong></p>
<p>Please consider to cite our <a href="https://www.biorxiv.org/content/10.1101/2020.08.12.248963v1" class="external-link">preprint</a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Download from BIOC at <br><a href="https://www.bioconductor.org/packages/msImpute">https://​www.bioconductor.org/​packages/​msImpute</a>
</li>
<li>Browse source code at <br><a href="https://github.com/DavisLaboratory/msImpute/">https://​github.com/​DavisLaboratory/​msImpute/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/DavisLaboratory/msImpute/issues">https://​github.com/​DavisLaboratory/​msImpute/​issues</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;=2)</li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Soroor Hediyeh-zadeh <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7513-6779" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/239129382" class="external-link"><img src="https://zenodo.org/badge/239129382.svg" alt="DOI"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Soroor Hediyeh-zadeh.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
